<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>光彩异联</title>
		<meta name="description" content="">
		<meta name="keywords" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<meta name="renderer" content="webkit">
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<script src="js/jquery-1.9.1.js"></script>
		<script src="js/mobiscroll.2.13.2.js"></script>
		<script src="js/jquery.uploadView.js"></script>
		<link href="css/mobiscroll.2.13.2.css" rel="stylesheet" />
		<link rel="stylesheet" href="css/amazeui.min.css" type="text/css" />
		<link rel="stylesheet" href="css/style.css" type="text/css" />
		<link rel="stylesheet" href="css/font.css" type="text/css" />
		<style>
		.js_uploadBox{position: relative;}
		.js_upFile{opacity: 0;background: #efefef;border: none;cursor: pointer;position: absolute;width: 100px;height: 100px;top: 46px;}
		
		</style>
	</head>

	<body>
		<header data-am-widget="header" class="am-header am-header-default sq-head ">
			<div class="am-header-left am-header-nav">
				<a href="javascript:history.back()" class="">
					<i class="am-icon-chevron-left"></i>
				</a>
			</div>
			<h1 class="am-header-title">
  	            <a href="" class="">编辑产品</a>
           </h1>
			<div class="am-header-right am-header-nav">
				<a href="javascript:" class="edit_okbtn">
				<!--release.html-->
					<i class="iconfont">&#xe615;</i>
				</a>
			</div>
		</header>
		<div style="height: 49px;"></div>
		<form action="" id="goodsEditForm">
			<div class="gd-edit">
				<h3>名称</h3>
				<input type="text" name="goodsname" placeholder="富氧水" class="cpms-name" onkeyup="this.value=this.value.replace(/^ +| +$/g,'')">
			</div>
			<div class="gd-edit">
				<h3>单价</h3>
				<input type="text" name="goodsprice" placeholder="100" class="cpms-name" onkeyup="value=value.replace(/[^\d.]/g,'')">
			</div>
			<div class="gd-edit">
				<h3>数量</h3>
				<input type="text" name="goodsnum" placeholder="100" class="cpms-name" onkeyup="this.value=this.value.replace(/[^\d]/g,'');">
			</div>
			<div class="gd-edit">
				<ul class="w_100">
					<h3 class="w_100 fl">描述</h3>
					<textarea id="cpms" class="cpms" name="describe" placeholder="限100字" cols="30" rows="4" maxlength="100"></textarea>
				</ul>
			</div>
			
			<!-- 图片描述 -->
			<div class="gd-edit">
				<div class="control-group js_uploadBox">
					<div class="btn-upload">
						<!-- <a href="javascript:void(0);"><i class="icon-upload"></i><span class="js_uploadText">上传</span>图片</a> -->
						<h3 class="w_100 fl js_uploadText">图片描述</h3>
						<input class="js_upFile" type="file" name="cover">
					</div>
					<div class="js_showBox" style="margin: 20px 0 0 0;">
						<img class="js_logoBox" src="images/uploadbtnimg.jpg" width="100px" height="100px">
					</div>
				</div>
			</div>
			<script>
				/*图片描述*/
				$(".js_upFile").uploadView({
					uploadBox: '.js_uploadBox',//设置上传框容器
					showBox : '.js_showBox',//设置显示预览图片的容器
					width : 100, //预览图片的宽度，单位px
					height : 100, //预览图片的高度，单位px
					allowType: ["gif", "jpeg", "jpg", "bmp", "png"], //允许上传图片的类型
					maxSize :4, //允许上传图片的最大尺寸，单位M
					success:function(e){
						
					}
				});
			</script>
			
			<div class="main">
			<div data-role="fieldcontain" class="demo-select-opt edit">
				<label for="names">分类至<i class="iconfont fr fg">&#xe604;</i></label>
				<select id="names" class="demo-test-select-opt" data-role="none">
					<optgroup label="家政">
						<option value="0">洗护</option>
						<option value="1">保洁</option>
						<option value="2">购衣</option>
						<option value="3">购衣</option>
					</optgroup>
					<optgroup label="饮食">
						<option value="78">生鲜</option>
						<option value="79">外卖</option>
						<option value="80">便利超市</option>
						<option value="81">私厨上门</option>
						<option value="82">XXX</option>
						<option value="83">XXX</option>
						<option value="84">XXX</option>
					</optgroup>
					<optgroup label="出行">
						<option value="118">轿车</option>
						<option value="119">亲子</option>
						<option value="120">车辆保养</option>
						<option value="121">《可爱的骨头》</option>
						<option value="122">《猜火车》</option>
					</optgroup>
					<optgroup label="物流">
						<option value="195">宅配物流</option>
						<option value="196">智能柜</option>
						<option value="197">物流众包</option>
						<option value="198">智能柜</option>
						<option value="199">搬家分类</option>
						<option value="200">搬家分类</option>
						<option value="201">搬家分类</option>
					</optgroup>
					<optgroup label="其他">
						<option value="261">宠物O2O</option>
						<option value="262">校园O2O</option>
						<option value="263">亲子养老</option>
						<option value="264">本地维修</option>
						<option value="265">婚庆美业</option>
						<option value="266">信息咨询</option>
						<option value="267">信息咨询</option>
					</optgroup>
				</select>
			</div>
			<div class="gd-edit">
				<h3>上传图片</h3>
			</div>
			<ul class="upload-box imgbox">
				<li><img src="images/test.png"></li>
				<li><img src="images/test.png"></li>
				<li>
					<a href="#" class="upload-addimg imgload"><i class="iconfont">&#xe614;</i></a>
				</li>
			</ul>
			<div class="errorbox" style="margin: 0 10px;font-size: 1.5rem;color: red;"></div>
		</form>
		
		<script type="text/javascript">
			$(function() {
				var curr = new Date().getFullYear();
				var opt = {
						'default': {
							theme: 'default',
							mode: 'scroller',
							display: 'modal',
							animate: 'fade'
						},
						'dateY': {
							preset: 'date',
							dateFormat: 'yyyy',
							defaultValue: new Date(new Date()),
							invalid: {
								daysOfWeek: [0, 6],
								daysOfMonth: ['5/1', '12/24', '12/25']
							},
							onBeforeShow: function(inst) {
								if(inst.settings.wheels[0].length > 1) {
									inst.settings.wheels[0].pop();
									inst.settings.wheels[0].pop();
								} else {
									null
								}
							}
						},
						'dateYM': {
							preset: 'date',
							dateFormat: 'yyyy-mm',
							defaultValue: new Date(new Date()),
							onBeforeShow: function(inst) {
								if(inst.settings.wheels[0].length > 2) {
									inst.settings.wheels[0].pop();
								} else {
									null
								}
							}
						},
						'dateYMD': {
							preset: 'date',
							dateFormat: 'yyyy-mm-dd',
							defaultValue: new Date(new Date()),
							invalid: {
								daysOfWeek: [0, 6],
								daysOfMonth: ['5/1', '12/24', '12/25']
							}
						},
						'datetime': {
							preset: 'datetime',
							minDate: new Date(2012, 3, 10, 9, 22),
							maxDate: new Date(2014, 7, 30, 15, 44),
							stepMinute: 5
						},
						'time': {
							preset: 'time'
						},
						'select': {
							preset: 'select'
						},
						'select-opt': {
							preset: 'select',
							group: true,
							width: 50
						}
					}
					//				$('#demo1').scroller($.extend(opt['dateY'], opt['default']));
					//				$('#demo2').scroller($.extend(opt['dateYM'], opt['default']));
					//				$('#demo3').scroller($.extend(opt['dateYMD'], opt['default']));
				$('.demo-test-select').scroller($.extend(opt['select'], opt['default']));
				$('.demo-test-select-opt').scroller($.extend(opt['select-opt'], opt['default']));
			});


			/*完成*/
			var $goodsEditForm=$('#goodsEditForm');
			var $edit_okbtn=$('.edit_okbtn');
			function goodsEditMethod(){
				var $goodsname=$('input[name="goodsname"]');
				var $goodsprice=$('input[name="goodsprice"]');
				var $goodsnum=$('input[name="goodsnum"]');
				var $describe=$('textarea[name="describe"]');
				var $imgbox=$('.imgbox li');
				var $names_dummy=$('#names_dummy');

				if($goodsname.val()==''){
					$('.errorbox').html('名称不能为空');
					return false;
				}else{
					if($goodsprice.val()==''){
						$('.errorbox').html('单价不能为空');
						return false;
					}else{
						if($goodsnum.val==''){
							$('.errorbox').html('数量不能为空');
							return false;
						}else{
							if($describe.val()==''){
								$('.errorbox').html('描述不能为空');
								return false;
							}else{
								if($names_dummy.val()==''){
									$('.errorbox').html('请选择分类');
									return false;
								}else{
									
									return true;
								}
								return true;
							}
							return true;
						}
						return true;
					}
					return true;
				}
			}

			$edit_okbtn.on('click',function(){
				if(goodsEditMethod()){
					$.ajax({
				    type: 'POST',//请求方法
				    url: 'js/json/GetDataList.json',//发送请求的地址(http://120.27.196.116:8022 Shop/GetDataList)
				    dataType:'json',//预期服务器返回的数据类型
				    data:$goodsEditForm.serialize(),	//发送到服务器的数据
				    contentType: 'application/json',//发送信息至服务器时内容编码类型。
				    success: function(data){
					    if(data.errorCode=='-1'){
					    	$('.errorbox').html(data.errorMsg);
					    }else if(data.errorCode=='-9'){
					    	$('.errorbox').html(data.errorMsg);
					    }else if(data.errorCode=='-10'){
					    	$('.errorbox').html(data.errorMsg);
					    }
					},
					error: function(xhr,type){
					  	alert('Ajax error!')
					}
				});
				};
			});
		</script>
	


</body>
</html>